import{u as O,a as P,_ as V}from"./DlJpEC_N.js";import{d as z,k as d,r as k,S as D,o as F,I as M,T as j,x as u,B as J,K as G,Q,z as t,A as o,O as X,P as q,J as H,y as v,_ as W}from"./CpzGuEEd.js";import{e as Y}from"./B3f_EFRp.js";import"./hOP14oPP.js";const Z={class:"container"},aa={key:0,class:"translation-interface"},ta={class:"header"},ea={class:"header-info"},sa={class:"progress-info"},na={class:"navigation-bar"},oa=["disabled"],la={class:"key-info"},ia={class:"catalogue-name"},ra={class:"key-index"},ca=["disabled"],da={key:0,class:"translation-content"},ua={class:"translation-card"},va={class:"original-section"},_a={class:"original-text"},pa={class:"translation-section"},ga=["for"],ha=["id","placeholder"],ya={class:"translation-tools"},ma=["disabled"],fa={class:"status-indicator"},ka={key:0,class:"status-badge translated"},ba={key:1,class:"status-badge untranslated"},Ta={key:1,class:"no-translation"},xa=z({__name:"[key]",setup(wa){const _=H(),h=M(),b=O(),E=P(),T=d(()=>_.params.system),y=d(()=>_.params.lang),m=d(()=>_.params.key),p=k(""),l=k([]),s=k(0),r=d(()=>l.value.length),e=d(()=>l.value[s.value]),R=d(()=>e.value?.catalogue||""),S={en:"English",es:"Spanish",fr:"French",de:"German",it:"Italian",pt:"Portuguese",ru:"Russian",ja:"Japanese",zh:"Chinese"},A=async()=>{try{await E.ensureSystemLoaded(T.value);const a=Y(globalThis.system,()=>{});globalThis.strings=a;const n=[];Object.entries(a).forEach(([g,B])=>{Array.from(B).forEach((L,K)=>{n.push({id:`${g}-${K}`,key:L,original:L,translation:"",translated:!1,catalogue:g})})}),l.value=n;const i=decodeURIComponent(m.value),c=l.value.findIndex(g=>g.key===i);c!==-1?s.value=c:s.value=0}catch(a){throw console.error("Failed to load translation data:",a),a}},x=()=>{if(s.value>0){const a=s.value-1;C(a)}},w=()=>{if(s.value<r.value-1){const a=s.value+1;C(a)}},C=a=>{if(a>=0&&a<r.value){s.value=a;const n=l.value[a]?.key;n&&n!==m.value&&h.replace({params:{..._.params,key:encodeURIComponent(n)}})}},f=()=>{e.value&&(e.value.modified=!0,e.value.translated=e.value.translation.trim()!=="")},N=()=>{e.value&&(e.value.translation="",f())},U=()=>{e.value&&(e.value.translation=e.value.original,f())},$=()=>{h.push(`/translate/${encodeURIComponent(T.value)}/${y.value}`)};D(()=>m.value,a=>{if(a&&l.value.length>0){const n=decodeURIComponent(a),i=l.value.findIndex(c=>c.key===n);i!==-1&&i!==s.value&&(s.value=i)}});const I=a=>{a.target&&a.target.tagName==="TEXTAREA"||(a.key==="ArrowLeft"&&s.value>0?x():a.key==="ArrowRight"&&s.value<r.value-1&&w())};return F(async()=>{p.value=S[y.value]||y.value;try{await b.withLoading(async()=>{await A()},"Loading translation..."),window.addEventListener("keydown",I)}catch(a){console.error("Failed to initialize translation page:",a),await h.push("/")}}),j(()=>{window.removeEventListener("keydown",I)}),(a,n)=>{const i=V;return v(),u("div",Z,[J(i,{title:"Loading Translation"}),Q(b).isLoading?G("",!0):(v(),u("div",aa,[t("div",ta,[t("button",{onClick:$,class:"back-button"},"← Back to Overview"),t("div",ea,[t("h1",null,o(p.value)+" Translation",1),t("div",sa,o(s.value+1)+" of "+o(r.value)+" strings ",1)])]),t("div",na,[t("button",{onClick:x,disabled:s.value===0,class:"nav-button prev-button"}," ← Previous ",8,oa),t("div",la,[t("span",ia,o(R.value),1),n[1]||(n[1]=t("span",{class:"key-separator"},"•",-1)),t("span",ra,o(s.value+1)+" / "+o(r.value),1)]),t("button",{onClick:w,disabled:s.value===r.value-1,class:"nav-button next-button"}," Next → ",8,ca)]),e.value?(v(),u("div",da,[t("div",ua,[t("div",va,[t("div",_a,o(e.value.original),1)]),t("div",pa,[t("label",{class:"section-label",for:`translation-${e.value.id}`},o(p.value)+" Translation ",9,ga),X(t("textarea",{id:`translation-${e.value.id}`,"onUpdate:modelValue":n[0]||(n[0]=c=>e.value.translation=c),onInput:f,placeholder:`Enter ${p.value} translation...`,class:"translation-input",rows:"4"},null,40,ha),[[q,e.value.translation]]),t("div",ya,[t("button",{onClick:N,class:"tool-button clear-button",disabled:!e.value.translation}," Clear ",8,ma),t("button",{onClick:U,class:"tool-button copy-button"}," Copy Original "),t("div",fa,[e.value.translated?(v(),u("span",ka," ✓ Translated ")):(v(),u("span",ba," — Untranslated "))])])]),n[2]||(n[2]=t("div",{class:"metadata-section"},null,-1))])])):(v(),u("div",Ta," Translation not found. "))]))])}}}),Ra=W(xa,[["__scopeId","data-v-21f3e165"]]);export{Ra as default};
//# sourceMappingURL=C38w0_nn.js.map
