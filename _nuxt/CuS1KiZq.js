import{u as E,a as M,_ as A}from"./DlJpEC_N.js";import{d as D,r as c,o as F,J as O,I as j,x as r,B as J,z as s,A as l,K as w,U as f,L as I,M as T,y as d,V as G,O as K,P,_ as q}from"./CpzGuEEd.js";import{e as H}from"./B3f_EFRp.js";import"./hOP14oPP.js";const Q={class:"container"},W={class:"translation-interface"},X={class:"header"},Y={class:"header-stats"},Z={class:"translation-content scrollable"},ss={class:"hierarchy-container"},ts={class:"hierarchy-item system-level"},as={class:"toggle-icon"},es={class:"system-name"},ns={class:"item-count"},os={key:0,class:"hierarchy-children"},ls=["onClick"],is={class:"toggle-icon"},cs={class:"catalogue-name"},rs={class:"item-count"},ds={key:0,class:"strings-table"},us={class:"col-original"},vs={class:"original-text"},ms={class:"col-translation"},_s=["onUpdate:modelValue","onInput","placeholder"],hs={class:"col-status"},gs={key:0,class:"status-badge translated"},ps={key:1,class:"status-badge untranslated"},ys={class:"col-actions"},bs=["onClick"],Cs=D({__name:"index",setup(ks){const _=O(),g=j(),$=E(),p=M(),h=c(""),y=c(""),S=c(0),b=c(0),x=c(""),C=c(0),m=c(!0),v=c(new Set),k=c([]),L=async a=>{try{a(85,"Loading translation strings...");const n=H(globalThis.system,(t,o)=>{a(85+Math.floor(t*.15),o)});globalThis.strings=n;const i=p.gameSystem;x.value=p.systemName||"Unknown System";const e=Object.entries(n).map(([t,o])=>({id:t,name:t,stringCount:o.size,strings:Array.from(o).map((u,R)=>({id:`${t}-${R}`,key:u,original:u,translation:"",translated:!1}))}));console.log(e),k.value=e,C.value=e.reduce((t,o)=>t+o.stringCount,0),S.value=C.value,b.value=e.reduce((t,o)=>t+o.strings.filter(u=>u.translated).length,0)}catch(n){throw console.error("Failed to load translation data:",n),n}};F(async()=>{const a=_.params.system;h.value=_.params.lang;const n={en:"English",es:"Spanish",fr:"French",de:"German",it:"Italian",pt:"Portuguese",ru:"Russian",ja:"Japanese",zh:"Chinese"};y.value=n[h.value]||h.value;try{await $.withLoading(async i=>{await p.ensureSystemLoaded(a,i),await L(i),await new Promise(e=>setTimeout(e,300))},"Initializing...")}catch(i){console.error("Failed to initialize translation page:",i),await g.push("/")}});const N=()=>{const a=_.params.system;g.push(`/languages/${encodeURIComponent(a)}`)},U=()=>{m.value=!m.value},V=a=>{v.value.has(a)?v.value.delete(a):v.value.add(a)},z=a=>{a.modified=!0,a.translated=a.translation.trim()!=="",b.value=k.value.reduce((n,i)=>n+i.strings.filter(e=>e.translated).length,0)},B=a=>{const n=_.params.system;g.push(`/translate/${encodeURIComponent(n)}/${h.value}/${encodeURIComponent(a.key)}`)};return(a,n)=>{const i=A;return d(),r("div",Q,[J(i,{title:"Loading Translation Data"}),s("div",W,[s("div",X,[s("button",{onClick:N,class:"back-button"},"← Back to Languages"),s("h1",null,"Translate to "+l(y.value),1),s("div",Y,[s("span",null,l(b.value)+"/"+l(S.value)+" translated",1)])]),s("div",Z,[s("div",ss,[s("div",ts,[s("button",{class:f(["hierarchy-toggle",{expanded:m.value}]),onClick:U},[s("span",as,l(m.value?"▼":"▶"),1),s("span",es,l(x.value),1),s("span",ns,"("+l(C.value)+" strings)",1)],2),m.value?(d(),r("div",os,[(d(!0),r(I,null,T(k.value,e=>(d(),r("div",{key:e.id,class:"hierarchy-item catalogue-level"},[s("button",{class:f(["hierarchy-toggle",{expanded:v.value.has(e.id)}]),onClick:t=>V(e.id)},[s("span",is,l(v.value.has(e.id)?"▼":"▶"),1),s("span",cs,l(e.name),1),s("span",rs,"("+l(e.stringCount)+" strings)",1)],10,ls),v.value.has(e.id)?(d(),r("div",ds,[n[0]||(n[0]=G('<div class="table-header" data-v-209cb1d5><div class="col-original" data-v-209cb1d5>Original Text</div><div class="col-translation" data-v-209cb1d5>Translation</div><div class="col-status" data-v-209cb1d5>Status</div><div class="col-actions" data-v-209cb1d5>Actions</div></div>',1)),(d(!0),r(I,null,T(e.strings,(t,o)=>(d(),r("div",{key:t.id,class:f(["table-row",{translated:t.translated,"row-even":o%2===0}])},[s("div",us,[s("div",vs,l(t.original),1)]),s("div",ms,[K(s("textarea",{"onUpdate:modelValue":u=>t.translation=u,onInput:u=>z(t),placeholder:`Enter ${y.value} translation...`,class:"translation-input",rows:"2"},null,40,_s),[[P,t.translation]])]),s("div",hs,[t.translated?(d(),r("span",gs,"✓")):(d(),r("span",ps,"—"))]),s("div",ys,[s("button",{onClick:u=>B(t),class:"edit-button",title:"Edit individually"}," ✎ ",8,bs)])],2))),128))])):w("",!0)]))),128))])):w("",!0)])])])])])}}}),Is=q(Cs,[["__scopeId","data-v-209cb1d5"]]);export{Is as default};
//# sourceMappingURL=CuS1KiZq.js.map
