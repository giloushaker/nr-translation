import{u as p,_ as g}from"./C0SQe-HK.js";import{d as f,r as y,o as h,Q as w,x as T,B as v,U as x,K as R,R as k,J as L,I as B,y as d,V as C,_ as I}from"./PIpq5hpi.js";import{u as S}from"./Cz3oM3EE.js";const z={class:"translate-container"},D=f({__name:"[lang]",setup(F){const e=L(),c=B(),l=p(),i=S(),r=y(!1),m=async t=>{try{t(20,"Loading translation strings..."),await i.ensureTranslationsLoaded(e.params.system,e.params.lang,(a,n)=>{t(20+Math.floor(a*.75),n)}),t(100,"Translation data loaded!")}catch(a){throw console.error("Failed to load translation data:",a),a}},u=async()=>{const t=e.params.system,a=e.params.lang,n=e.path.includes("/translate/");if(n&&(!t||!a)){console.log("Redirecting to home due to missing params on translate route"),await c.push("/");return}if(!n){r.value=!0;return}try{await l.withLoading(async o=>{if(await m(o),i.canSync){o(95,"Syncing from backend...");try{await i.syncFromBackend(t,a,"client-wins"),console.log("Auto-sync completed successfully")}catch(s){console.warn("Auto-sync failed:",s)}}await new Promise(s=>setTimeout(s,300))},"Initializing..."),r.value=!0}catch(o){console.error("Failed to initialize translation page:",o),await c.push("/")}};return h(()=>{u()}),w(()=>[e.params.system,e.params.lang],async([t,a],[n,o]=[])=>{const s=t!==n||a!==o,_=e.path.includes("/translate/");s&&_&&n!==void 0&&(console.log("System/Language changed:",{from:[n,o],to:[t,a]}),r.value=!1,await u())}),(t,a)=>{const n=g,o=C;return d(),T("div",z,[v(n,{title:"Loading Translation Data"}),!k(l).isLoading&&r.value?(d(),x(o,{key:0})):R("",!0)])}}}),A=I(D,[["__scopeId","data-v-756e1ebc"]]);export{A as default};
//# sourceMappingURL=BLrrUQ0e.js.map
