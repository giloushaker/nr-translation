import{d as E,r as v,x as u,K as $,N as M,z as t,O as S,Y as h,Z as D,y as r,_ as I,A as c,k as b,Q as J,o as ct,B,$ as vt,a0 as K,a1 as V,L as P,M as z,J as pt,I as mt,P as yt}from"./esT4bswo.js";import{u as ft}from"./D7ewN1DE.js";const gt={class:"dialog"},bt={class:"dialog-header"},St={class:"dialog-content"},kt={class:"format-options"},$t={class:"format-option"},Ct={class:"format-option"},ht={class:"format-option"},_t={class:"format-option"},wt={class:"export-options"},Ft={class:"checkbox-option"},Tt=["disabled"],Ut={class:"checkbox-option"},Vt=["disabled"],Et={class:"dialog-footer"},It=E({__name:"ExportDialog",props:{show:{type:Boolean}},emits:["close","export"],setup(_,{emit:p}){const C=p,o=v("json"),y=v(!1),a=v(!1),i=()=>{C("export",{format:o.value,onlyTranslated:y.value,onlyUntranslated:a.value})};return(f,s)=>f.show?(r(),u("div",{key:0,class:"dialog-overlay",onClick:s[8]||(s[8]=M(e=>f.$emit("close"),["self"]))},[t("div",gt,[t("div",bt,[s[9]||(s[9]=t("h2",null,"Export Translations",-1)),t("button",{onClick:s[0]||(s[0]=e=>f.$emit("close")),class:"dialog-close"},"×")]),t("div",St,[s[20]||(s[20]=t("p",null,"Select export format:",-1)),t("div",kt,[t("label",$t,[S(t("input",{type:"radio","onUpdate:modelValue":s[1]||(s[1]=e=>o.value=e),value:"json"},null,512),[[h,o.value]]),s[10]||(s[10]=t("span",null,"JSON (Full)",-1)),s[11]||(s[11]=t("small",null,"Complete translation data with metadata",-1))]),t("label",Ct,[S(t("input",{type:"radio","onUpdate:modelValue":s[2]||(s[2]=e=>o.value=e),value:"json-kv"},null,512),[[h,o.value]]),s[12]||(s[12]=t("span",null,"JSON (Key-Value)",-1)),s[13]||(s[13]=t("small",null,"Simple key-value pairs format",-1))]),t("label",ht,[S(t("input",{type:"radio","onUpdate:modelValue":s[3]||(s[3]=e=>o.value=e),value:"csv"},null,512),[[h,o.value]]),s[14]||(s[14]=t("span",null,"CSV",-1)),s[15]||(s[15]=t("small",null,"Spreadsheet-compatible format",-1))]),t("label",_t,[S(t("input",{type:"radio","onUpdate:modelValue":s[4]||(s[4]=e=>o.value=e),value:"po"},null,512),[[h,o.value]]),s[16]||(s[16]=t("span",null,"PO (gettext)",-1)),s[17]||(s[17]=t("small",null,"GNU gettext format for translation tools",-1))])]),t("div",wt,[t("label",Ft,[S(t("input",{type:"checkbox","onUpdate:modelValue":s[5]||(s[5]=e=>y.value=e),disabled:a.value},null,8,Tt),[[D,y.value]]),s[18]||(s[18]=t("span",null,"Export only translated strings",-1))]),t("label",Ut,[S(t("input",{type:"checkbox","onUpdate:modelValue":s[6]||(s[6]=e=>a.value=e),disabled:y.value},null,8,Vt),[[D,a.value]]),s[19]||(s[19]=t("span",null,"Export only untranslated strings",-1))])])]),t("div",Et,[t("button",{onClick:s[7]||(s[7]=e=>f.$emit("close")),class:"dialog-button cancel"},"Cancel"),t("button",{onClick:i,class:"dialog-button primary"},"Export")])])])):$("",!0)}}),Nt=Object.assign(I(It,[["__scopeId","data-v-845f1c29"]]),{__name:"ExportDialog"}),xt={class:"dialog"},Bt={class:"dialog-header"},Dt={class:"dialog-content"},Mt={class:"submit-options"},Ot={class:"checkbox-option"},jt={key:0,class:"submit-status"},Rt={class:"dialog-footer"},At=["disabled"],Jt=E({__name:"SubmitDialog",props:{show:{type:Boolean},isSubmitting:{type:Boolean}},emits:["close","submit"],setup(_,{emit:p}){const C=p,o=v(!0),y=()=>{C("submit",{onlyModified:o.value})};return(a,i)=>a.show?(r(),u("div",{key:0,class:"dialog-overlay",onClick:i[3]||(i[3]=M(f=>a.$emit("close"),["self"]))},[t("div",xt,[t("div",Bt,[i[4]||(i[4]=t("h2",null,"Submit Translations",-1)),t("button",{onClick:i[0]||(i[0]=f=>a.$emit("close")),class:"dialog-close"},"×")]),t("div",Dt,[i[8]||(i[8]=t("p",null,"Submit translations to configured backend",-1)),t("div",Mt,[t("label",Ot,[S(t("input",{type:"checkbox","onUpdate:modelValue":i[1]||(i[1]=f=>o.value=f)},null,512),[[D,o.value]]),i[5]||(i[5]=t("span",null,"Submit only modified translations",-1)),i[6]||(i[6]=t("small",null,"Recommended to avoid overwriting unchanged translations",-1))])]),a.isSubmitting?(r(),u("div",jt,i[7]||(i[7]=[t("p",null,"Submitting translations...",-1)]))):$("",!0)]),t("div",Rt,[t("button",{onClick:i[2]||(i[2]=f=>a.$emit("close")),class:"dialog-button cancel"},"Cancel"),t("button",{onClick:y,class:"dialog-button primary",disabled:a.isSubmitting},c(a.isSubmitting?"Submitting...":"Submit"),9,At)])])])):$("",!0)}}),Kt=Object.assign(I(Jt,[["__scopeId","data-v-c94acd5f"]]),{__name:"SubmitDialog"}),Pt={class:"dialog"},zt={class:"dialog-header"},Lt={class:"dialog-content"},Gt={key:0},Ht={class:"file-input-section"},Qt={key:0,class:"selected-file"},Yt={key:1},Zt={key:2,class:"conflict-info"},qt={key:3,class:"sync-options"},Wt={class:"radio-option"},Xt={class:"radio-option"},ts={class:"radio-option"},ss={key:4,class:"sync-status"},es={class:"dialog-footer"},ls=["disabled"],ns=E({__name:"SyncDialog",props:{show:{type:Boolean},syncConflicts:{},selectedFile:{},isSyncing:{type:Boolean},canSync:{type:Boolean}},emits:["close","file-select","sync"],setup(_,{emit:p}){const C=_,o=p,y=v(null),a=v("ask-user"),i=s=>{const e=s.target;e.files&&e.files.length>0&&o("file-select",e.files[0])},f=()=>{o("sync",{syncStrategy:a.value,selectedFile:C.selectedFile})};return(s,e)=>s.show?(r(),u("div",{key:0,class:"dialog-overlay",onClick:e[5]||(e[5]=M(g=>s.$emit("close"),["self"]))},[t("div",Pt,[t("div",zt,[e[6]||(e[6]=t("h2",null,"Sync Translations",-1)),t("button",{onClick:e[0]||(e[0]=g=>s.$emit("close")),class:"dialog-close"},"×")]),t("div",Lt,[s.canSync?(r(),u("div",Yt,e[10]||(e[10]=[t("p",null,"Backend configured and ready for sync",-1)]))):(r(),u("div",Gt,[e[8]||(e[8]=t("p",null,[t("strong",null,"No backend configured")],-1)),e[9]||(e[9]=t("p",null,"Select a translation file to import:",-1)),t("div",Ht,[t("input",{type:"file",ref_key:"fileInput",ref:y,onChange:i,accept:".json,.po,.csv",class:"file-input"},null,544),e[7]||(e[7]=t("p",{class:"file-help"},"Supported formats: JSON, PO (gettext), CSV",-1)),s.selectedFile?(r(),u("div",Qt," Selected: "+c(s.selectedFile.name),1)):$("",!0)])])),s.syncConflicts.length>0?(r(),u("div",Zt,[t("p",null,[t("strong",null,c(s.syncConflicts.length)+" conflicts detected",1)]),e[11]||(e[11]=t("p",null,"Some translations have been modified both locally and on the server.",-1))])):$("",!0),s.selectedFile||s.canSync?(r(),u("div",qt,[e[18]||(e[18]=t("p",null,"How would you like to handle conflicts?",-1)),t("label",Wt,[S(t("input",{type:"radio","onUpdate:modelValue":e[1]||(e[1]=g=>a.value=g),value:"server-wins"},null,512),[[h,a.value]]),e[12]||(e[12]=t("span",null,"Import wins",-1)),e[13]||(e[13]=t("small",null,"Overwrite local changes with imported versions",-1))]),t("label",Xt,[S(t("input",{type:"radio","onUpdate:modelValue":e[2]||(e[2]=g=>a.value=g),value:"client-wins"},null,512),[[h,a.value]]),e[14]||(e[14]=t("span",null,"Keep local changes",-1)),e[15]||(e[15]=t("small",null,"Keep your local translations, ignore imported changes",-1))]),t("label",ts,[S(t("input",{type:"radio","onUpdate:modelValue":e[3]||(e[3]=g=>a.value=g),value:"ask-user"},null,512),[[h,a.value]]),e[16]||(e[16]=t("span",null,"Ask me for each conflict",-1)),e[17]||(e[17]=t("small",null,"Show me each conflict and let me choose",-1))])])):$("",!0),s.isSyncing?(r(),u("div",ss,[t("p",null,c(s.selectedFile?"Importing translations...":"Syncing translations..."),1)])):$("",!0)]),t("div",es,[t("button",{onClick:e[4]||(e[4]=g=>s.$emit("close")),class:"dialog-button cancel"},"Cancel"),t("button",{onClick:f,class:"dialog-button primary",disabled:s.isSyncing||!s.selectedFile&&!s.canSync},c(s.isSyncing?s.selectedFile?"Importing...":"Syncing...":s.selectedFile?"Import":"Sync"),9,ls)])])])):$("",!0)}}),os=Object.assign(I(ns,[["__scopeId","data-v-4e4dce3f"]]),{__name:"SyncDialog"}),as={class:"container"},is={class:"translation-interface"},ds={class:"header"},us={class:"header-stats"},rs={class:"header-actions"},cs=["title"],vs=["disabled","title"],ps={class:"filter-controls"},ms={class:"filter-group"},ys={class:"filter-stats"},fs={class:"filter-count"},gs={class:"translation-content scrollable"},bs={class:"hierarchy-container"},Ss={class:"hierarchy-item system-level"},ks={class:"toggle-icon"},$s={class:"system-name"},Cs={class:"item-count"},hs={key:0,class:"hierarchy-children"},_s=["onClick"],ws={class:"toggle-icon"},Fs={class:"catalogue-name"},Ts={class:"item-count"},Us={key:0,class:"strings-table"},Vs={class:"col-original"},Es={class:"original-text"},Is={class:"col-translation"},Ns=["onUpdate:modelValue","onInput","placeholder"],xs={class:"col-status"},Bs=["onClick","title"],Ds={key:0,class:"status-icon check"},Ms={key:1,class:"status-icon cross"},Os={class:"col-actions"},js=["onClick"],Rs=E({__name:"index",setup(_){const p=pt(),C=mt(),o=ft(),y=v(!0),a=v(new Set),i=v("all"),f=v([]),s=v(0),e=v(!1),g=v(!1),w=v(!1),F=v([]),T=v(null),L=b(()=>o.systemName),O=b(()=>o.catalogues),j=b(()=>o.totalStrings),G=b(()=>o.translatedCount),H=b(()=>o.systemStringCount),Q=(l,n)=>{switch(n){case"translated":return l.translated;case"untranslated":return!l.translated;case"modified":return l.modified;case"untranslated-modified":return!l.translated||l.modified;default:return!0}},N=()=>{const l=O.value.map(n=>{const d=n.strings.filter(m=>Q(m,i.value));return{...n,filteredStrings:d,filteredStringCount:d.length}}).filter(n=>n.filteredStringCount>0);f.value=l,s.value=l.reduce((n,d)=>n+d.filteredStringCount,0)},Y=b(()=>f.value),Z=b(()=>s.value),R=b(()=>o.canSubmit),q=b(()=>o.isSubmitting),A=b(()=>o.canSync),W=b(()=>o.isSyncing),k=b(()=>p.params.lang),x=b(()=>({en:"English",es:"Spanish",fr:"French",de:"German",it:"Italian",pt:"Portuguese",ru:"Russian",ja:"Japanese",zh:"Chinese"})[k.value]||k.value),X=()=>{const l=p.params.system;C.push(`/languages/${encodeURIComponent(l)}`)},tt=()=>{y.value=!y.value},st=l=>{a.value.has(l)?a.value.delete(l):a.value.add(l)},et=l=>{o.updateTranslation(l.id,l.translation,p.params.system,k.value)},lt=l=>{l.translated?o.updateTranslation(l.id,"",p.params.system,k.value):o.updateTranslation(l.id,l.original,p.params.system,k.value)},nt=l=>{const n=p.params.system;C.push(`/translate/${encodeURIComponent(n)}/${k.value}/${encodeURIComponent(l.key)}`)},ot=l=>{T.value=l},at=()=>{w.value=!1,T.value=null,F.value=[]},it=async l=>{try{let n;if(l.selectedFile?n=await o.syncFromFile(l.selectedFile,p.params.system,k.value,l.syncStrategy):n=await o.syncFromBackend(p.params.system,k.value,l.syncStrategy),n.conflicts.length>0&&l.syncStrategy==="ask-user"){F.value=n.conflicts;return}w.value=!1,F.value=[],T.value=null;const d=l.selectedFile?"Translations imported successfully":"Translations synced successfully";console.log(d)}catch(n){console.error("Failed to sync translations:",n),alert("Failed to sync translations: "+n.message)}},dt=async l=>{try{await o.submitToBackend(p.params.system,k.value,l.onlyModified),g.value=!1,console.log("Translations submitted successfully")}catch(n){console.error("Failed to submit translations:",n),alert("Failed to submit translations: "+n.message)}},ut=l=>{o.downloadExport(l.format,k.value,x.value,o.systemName,l.onlyTranslated,l.onlyUntranslated),e.value=!1};return J(i,()=>{N()}),J(O,()=>{N()},{deep:!0}),ct(()=>{N()}),(l,n)=>(r(),u("div",as,[B(Nt,{show:e.value,onClose:n[0]||(n[0]=d=>e.value=!1),onExport:ut},null,8,["show"]),B(Kt,{show:g.value,"is-submitting":q.value,onClose:n[1]||(n[1]=d=>g.value=!1),onSubmit:dt},null,8,["show","is-submitting"]),B(os,{show:w.value,"sync-conflicts":F.value,"selected-file":T.value,"is-syncing":W.value,"can-sync":A.value,onClose:at,onFileSelect:ot,onSync:it},null,8,["show","sync-conflicts","selected-file","is-syncing","can-sync"]),t("div",is,[t("div",ds,[t("button",{onClick:X,class:"back-button"},"← Back to Languages"),t("h1",null,"Translate to "+c(x.value),1),t("div",us,[t("span",null,c(G.value)+"/"+c(j.value)+" translated",1)]),t("div",rs,[t("button",{onClick:n[2]||(n[2]=d=>w.value=!0),class:"sync-button",title:A.value?"Sync translations from backend":"Import translations from file"}," Sync Translations ",8,cs),t("button",{onClick:n[3]||(n[3]=d=>g.value=!0),class:"submit-button",disabled:!R.value,title:R.value?"Submit translations to backend":"No backend configured"}," Submit Translations ",8,vs),t("button",{onClick:n[4]||(n[4]=d=>e.value=!0),class:"export-button"}," Export Translations ")])]),t("div",ps,[t("div",ms,[n[7]||(n[7]=t("label",{for:"filter-select"},"Show:",-1)),S(t("select",{id:"filter-select","onUpdate:modelValue":n[5]||(n[5]=d=>i.value=d),class:"filter-select"},n[6]||(n[6]=[K('<option value="all" data-v-668be59f>All Strings</option><option value="translated" data-v-668be59f>Translated Only</option><option value="untranslated" data-v-668be59f>Untranslated Only</option><option value="modified" data-v-668be59f>Modified Only</option><option value="untranslated-modified" data-v-668be59f>Untranslated + Modified</option>',5)]),512),[[vt,i.value]])]),t("div",ys,[t("span",fs,c(Z.value)+" of "+c(j.value)+" strings shown",1)])]),t("div",gs,[t("div",bs,[t("div",Ss,[t("button",{class:V(["hierarchy-toggle",{expanded:y.value}]),onClick:tt},[t("span",ks,c(y.value?"▼":"▶"),1),t("span",$s,c(L.value),1),t("span",Cs,"("+c(H.value)+" strings)",1)],2),y.value?(r(),u("div",hs,[(r(!0),u(P,null,z(Y.value,d=>(r(),u("div",{key:d.id,class:"hierarchy-item catalogue-level"},[t("button",{class:V(["hierarchy-toggle",{expanded:a.value.has(d.id)}]),onClick:m=>st(d.id)},[t("span",ws,c(a.value.has(d.id)?"▼":"▶"),1),t("span",Fs,c(d.name),1),t("span",Ts,"("+c(d.filteredStringCount)+" of "+c(d.stringCount)+" strings)",1)],10,_s),a.value.has(d.id)&&d.filteredStrings.length>0?(r(),u("div",Us,[n[8]||(n[8]=K('<div class="table-header" data-v-668be59f><div class="col-original" data-v-668be59f>Original Text</div><div class="col-translation" data-v-668be59f>Translation</div><div class="col-status" data-v-668be59f>Status</div><div class="col-actions" data-v-668be59f>Actions</div></div>',1)),(r(!0),u(P,null,z(d.filteredStrings,(m,rt)=>(r(),u("div",{key:m.id,class:V(["table-row",{translated:m.translated,modified:m.modified,"row-even":rt%2===0}])},[t("div",Vs,[t("div",Es,c(m.original),1)]),t("div",Is,[S(t("textarea",{"onUpdate:modelValue":U=>m.translation=U,onInput:U=>et(m),placeholder:`Enter ${x.value} translation...`,class:"translation-input",rows:"2"},null,40,Ns),[[yt,m.translation]])]),t("div",xs,[t("button",{onClick:U=>lt(m),class:V(["status-toggle",{translated:m.translated}]),title:m.translated?"Mark as untranslated":"Mark as translated"},[m.translated?(r(),u("span",Ds,"✓")):(r(),u("span",Ms,"✗"))],10,Bs)]),t("div",Os,[t("button",{onClick:U=>nt(m),class:"edit-button",title:"Edit individually"}," ✎ ",8,js)])],2))),128))])):$("",!0)]))),128))])):$("",!0)])])])])]))}}),Ks=I(Rs,[["__scopeId","data-v-668be59f"]]);export{Ks as default};
//# sourceMappingURL=BI_0-cbb.js.map
