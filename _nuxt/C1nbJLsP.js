const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./rK6Acd-G.js","./CDRs11_G.js","./C4ErDbKS.js","./DEcQ07UY.js","./lvShBcCt.js","./Czx6p1fB.js","./Ct-5TeT_.js"])))=>i.map(i=>d[i]);
import{S as d}from"./esT4bswo.js";class w{constructor(t){this.systemId=t}system;getId(){return`bs-${this.systemId}`}getName(){return`${this.systemId}`}async getTranslations(t,a){this.system||await this.loadSystem(a);const{extractStrings:i}=await d(async()=>{const{extractStrings:n}=await import("./rK6Acd-G.js");return{extractStrings:n}},__vite__mapDeps([0,1,2]),import.meta.url),e=i(this.system,a||(()=>{})),r=[],s=[];return Object.entries(e).forEach(([n,c])=>{const l=[];Array.from(c).forEach((m,u)=>{const o={id:`${n}-${u}`,key:m,original:m,translation:"",translated:!1,catalogue:n};l.push(o),s.push(o)}),r.push({id:n,name:n,stringCount:c.size,strings:l})}),{strings:e,catalogues:r,translations:s}}async loadSystem(t){const a=t||(()=>{});try{this.systemId.includes("/")?await this.loadGitHubSystem(a):await this.loadLocalSystem(a)}catch(i){throw console.error("Failed to load system:",i),i}}async loadGitHubSystem(t){const{getRepoZip:a}=await d(async()=>{const{getRepoZip:o}=await import("./DEcQ07UY.js");return{getRepoZip:o}},__vite__mapDeps([3,1,4]),import.meta.url),{convertToJson:i,isAllowedExtension:e}=await d(async()=>{const{convertToJson:o,isAllowedExtension:S}=await import("./Czx6p1fB.js");return{convertToJson:o,isAllowedExtension:S}},__vite__mapDeps([5,4,1,2]),import.meta.url),{GameSystemFiles:r}=await d(async()=>{const{GameSystemFiles:o}=await import("./Ct-5TeT_.js");return{GameSystemFiles:o}},__vite__mapDeps([6,2,1,5,4]),import.meta.url),[s,n]=this.systemId.split("/");t(10,`Connecting to GitHub repository ${s}/${n}...`);const c=new r;t(20,"Downloading repository files...");const l=await a(s,n);t(40,"Processing game system files...");const m=l.length;let u=0;for(const[o,S]of l){if(S.isDirectory||!e(o)){u++;continue}const h=await S.text(),y=await i(h,o);y.gameSystem?(await c.setSystem(y),t(40+Math.floor(u/m*50),`Loading ${y.gameSystem.name}...`)):y.catalogue&&await c.setCatalogue(y),u++,t(40+Math.floor(u/m*50))}t(95,"Finalizing..."),this.system=c}async loadLocalSystem(t){t(10,"Loading local system...");const a=localStorage.getItem("local_systems")||"[]",e=JSON.parse(a).find(s=>s.id===this.systemId);if(!e)throw new Error(`Local system not found: ${this.systemId}`);t(50,"Processing system data...");const{GameSystemFiles:r}=await d(async()=>{const{GameSystemFiles:s}=await import("./Ct-5TeT_.js");return{GameSystemFiles:s}},__vite__mapDeps([6,2,1,5,4]),import.meta.url);if(this.system=new r,e.gameSystem&&await this.system.setSystem(e.gameSystem),e.catalogues)for(const s of Object.values(e.catalogues))await this.system.setCatalogue(s);t(90,"System loaded successfully")}}class f{constructor(){}getId(){return"newrecruit"}getName(){return"NewRecruit (Placeholder)"}async getTranslations(t,a){a?.(10,"Loading NewRecruit interface strings...");const i=["Welcome to NewRecruit","Create your army","Select unit","Add weapon","Remove model","Save roster","Load roster","Export to PDF","Settings","Help","About","Points cost","Unit options","Special rules","Army composition"];a?.(50,"Processing interface strings...");const e="interface",r=new Set(i),s=[],n=[];i.forEach((m,u)=>{const o={id:`${e}-${u}`,key:m,original:m,translation:"",translated:!1,catalogue:e};s.push(o),n.push(o)});const c={[e]:r},l=[{id:e,name:"Interface Strings",stringCount:r.size,strings:s}];return a?.(100,"NewRecruit strings loaded"),{strings:c,catalogues:l,translations:n}}}class T{constructor(t){this.systemId=t}getId(){return`t9a-${this.systemId}`}getName(){return`${this.systemId} (The 9th Age)`}async getTranslations(t,a){throw new Error("T9A translation source not yet implemented")}}class I{constructor(t,a="json"){this.jsonData=t,this.sourceId=a}getId(){return this.sourceId}getName(){return this.jsonData.name||"JSON Translation Source"}async getTranslations(t,a){const i={},e=[],r=[];if(this.jsonData.translatable_strings){const s="main",n=new Set,c=[];this.jsonData.translatable_strings.forEach((l,m)=>{n.add(l);const u={id:`${s}-${m}`,key:l,original:l,translation:"",translated:!1,catalogue:s};c.push(u),r.push(u)}),i[s]=n,e.push({id:s,name:s,stringCount:n.size,strings:c})}return{strings:i,catalogues:e,translations:r}}}function p(g){return g==="newrecruit"?new f:new w(g)}async function E(g){return p(g).getName()}export{w as BSDataTranslationSource,I as JSONTranslationSource,f as NewRecruitTranslationSource,T as T9ATranslationSource,p as createTranslationSourceForSystem,E as getSystemName};
//# sourceMappingURL=C1nbJLsP.js.map
